<h1>Dashboard</h1>

<div class="stats-grid">
  <article class="stat-card">
    <h3>Total Documents</h3>
    <div class="stat-value" id="total-documents"><%= @stats[:total_documents] %></div>
  </article>
  
  <article class="stat-card">
    <h3>Processed Documents</h3>
    <div class="stat-value" id="processed-documents"><%= @stats[:processed_documents] %></div>
  </article>
  
  <article class="stat-card">
    <h3>Total Embeddings</h3>
    <div class="stat-value" id="total-embeddings"><%= @stats[:total_embeddings] %></div>
  </article>
  
  <article class="stat-card">
    <h3>Pending Jobs</h3>
    <div class="stat-value" id="sidekiq-enqueued"><%= @stats[:sidekiq_stats].enqueued %></div>
  </article>
</div>

<article>
  <header>
    <h2>Recent Documents</h2>
    <a href="/admin/documents" role="button">View All Documents</a>
  </header>
  
  <table role="grid">
    <thead>
      <tr>
        <th>Title</th>
        <th>URL</th>
        <th>Status</th>
        <th>Embeddings</th>
        <th>Last Updated</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @recent_documents.each do |doc| %>
        <tr>
          <td><%= doc.title %></td>
          <td><%= doc.url %></td>
          <td><%= doc.processed ? 'Processed' : 'Pending' %></td>
          <td><%= doc.embedding_count %></td>
          <td><%= doc.updated_at.strftime('%Y-%m-%d %H:%M:%S') %></td>
          <td>
            <a href="/admin/documents/<%= doc.id %>" role="button" class="outline">View</a>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</article>

<article>
  <header>
    <h2>Job Queue Status</h2>
    <a href="/admin/sidekiq-stats" role="button">View Queue Details</a>
  </header>

  <div class="stats-grid">
    <article class="stat-card">
      <h3>Processed Jobs</h3>
      <div class="stat-value" id="sidekiq-processed"><%= @stats[:sidekiq_stats].processed %></div>
    </article>

    <article class="stat-card">
      <h3>Failed Jobs</h3>
      <div class="stat-value" id="sidekiq-failed"><%= @stats[:sidekiq_stats].failed %></div>
    </article>

    <article class="stat-card">
      <h3>Active Workers</h3>
      <div class="stat-value" id="sidekiq-workers"><%= Sidekiq::Workers.new.size %></div>
    </article>
  </div>
</article>
